***************************
** Evaluacion de Impacto **
**   Taller de Repaso    **
* Andrea Margarita Beleño *
** Yuli Castellanos Niño **
* Maria Camila Cely Moreno*
***************************


*Pregunta de investigacion: la corrupcion politica incrementa la incidencia de trampa por parte de los estudiantes?


******************************
* establecer directorio y ruta  ** varia de acuerdo al pc de cada quien

*cd "C:\Users\Camila Cely\Documents\GitHub\Taller_Regresiones"

ssc install ftools
ssc install reghdfe /*Para instalar paquetes de stata*/

cd "E:\MAESTRIA UNIANDES\EVALUACION DE IMPACTO\Taller_Regresiones"
use "corruption.dta"

br
summarize

******************************
***PUNTO 1

* Revision de variables

***
* Corrupt: toma valor de 1 si hubo corrupcion en el municipio m en el año t
sum Corrupt
/*
    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     Corrupt |    102,637    .1537555    .3607159          0          1 */

***	 
* 	Auditada : toma valor de 1 si fueron publicadas auditorias  en el municipio m en el año t
sum Auditada
/*
    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
    Auditada |    102,637    .3248244    .4683115          0          1 */

***
* clavedelaescuela: esta como texto, es un identificador para hacer los efectos fijos por escuela

***
* year: para efectos fijos de tiempo (anual) **notar que aqui hay tres observaciones mas que en el resto de variables, no se por que
sum year
/*    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |    102,640    2010.443    1.955598       2006       2013 */

***
* GradoSecundaria : grado de los estudiantes
sum GradoSecundaria
/*    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
GradoSecun~a |    102,637    2.145445    .8319514          1          3 */

***
* PartidoDesf : corresponde al partido politico activo, variable de texto

***
* AlreadyAudited: toma el valor de 1 si el municipio ya fue auditado en el pasado

sum AlreadyAudited
/*
    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
AlreadyAud~d |    102,637    .7081559    .4546132          0          1 */

***
*CorruptPast : Toma el valor e 1 si el municipio fue corrupto en el pasado
sum CorruptPast

/*    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
 CorruptPast |    102,637    .4697819    .4990885          0          1 */
 
***
*Numero de homicidios per capita por municipio por año
sum HOMI_CAP_MUN

/*   Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
HOMI_CAP_MUN |    102,637     .000217    .0003278          0   .0045558 */

***
* total de impuestos recolectados en el municipio m en el año texto
sum total

/*    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       total |    102,637    1.00e+09    1.31e+09          0   7.76e+09 */

*   nota: esta variable debemos manejarla en logaritmo, por eso hay que crear una nueva variable *

gen log_total = log(total) /*dice que se generan 4344 missing values, esto es porque hay valores de cero*/

sum log_total

/*    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   log_total |     98,296    19.97693    1.322248   15.48875   22.77245
   
   notamos que se reducen las observaciones si dejamos los ceros tal cual, porque el logaritmo de cero se vuelve missing value*/
   
   
*Vamos a duplicarla y reemplazarle los valores de cero para que no se generen los missing values en la variable de logaritmo

gen total2 = total
sum total2

replace total2=1 if total2==0 
sum total2 
*aqui ya vemos que el valor minimo cambio a 1*

*ahora si voy a crear logaritmo

gen log_total2 = log(total2)
sum log_total2

/*    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  log_total2 |    102,637    19.13201    4.223687          0   22.77245*/
  

***
* MismoPartidoG = toma el valor de 1 si el partido politico del municipio m en el año t esta alineado con el nacional

sum MismoPartidoG

/*    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
MismoParti~G |    102,640    .3171863    .4653829          0          1*/


* por ultimo, ver cuales variables tienen missings
mdesc


 /*  Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
   clavedelae~a |           3        102,640           0.00
          turno |           3        102,640           0.00
           prop |         507        102,640           0.49
   GradoSecun~a |           3        102,640           0.00
           year |           0        102,640           0.00
      clave_mun |           3        102,640           0.00
   unauthorized |           3        102,640           0.00
       Auditada |           3        102,640           0.00
   AlreadyAud~d |           3        102,640           0.00
    CorruptPast |           3        102,640           0.00
        Corrupt |           3        102,640           0.00
   HOMI_CAP_MUN |           3        102,640           0.00
          total |           3        102,640           0.00
        mis_tot |           3        102,640           0.00
    PartidoDesf |           3        102,640           0.00
   MismoParti~G |           0        102,640           0.00
      log_total |       4,344        102,640           4.23
         total2 |           3        102,640           0.00
     log_total2 |           3        102,640           0.00
*/


******************************
***PUNTO 2

* correr las siguientes regresiones

* a) regresion simple de variable dependiente contra independiente principal

reg prop Corrupt
outreg2  using myreg3.doc, replace ctitle((a)) keep (Corrupt) nocons 
*no sale significativa la variable Corrupt 


/*      Source |       SS           df       MS      Number of obs   =   102,133
-------------+----------------------------------   F(1, 102131)    =      1.50
       Model |  .023700688         1  .023700688   Prob > F        =    0.2203
    Residual |  1610.96488   102,131  .015773515   R-squared       =    0.0000
-------------+----------------------------------   Adj R-squared   =    0.0000
       Total |  1610.98858   102,132  .015773593   Root MSE        =    .12559

------------------------------------------------------------------------------
        prop |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     Corrupt |   .0013363   .0010901     1.23   0.220    -.0008004    .0034729
       _cons |   .0408682   .0004271    95.68   0.000      .040031    .0417054
------------------------------------------------------------------------------*/


* b) regresion simple de variable dependiente contra independiente principal + controles

*Para la variable PartidoDesf, se convertirá a numérica 
egen nPartidoDesf= group(PartidoDesf)

sum PartidoDesf
sum nPartidoDesf

reg prop Corrupt i.nPartidoDesf Auditada CorruptPast HOMI_CAP_MUN log_total2 MismoPartidoG /* aqui le puse i.nPartidoDesf porque si no, no la toma como categorica sino como numerica*/ 
outreg2  using myreg3.doc, append ctitle((b)) keep (Corrupt) nocons addtext(Partido, YES, Auditado?, YES, Corrupt_past, YES, Homicidio, YES, Ingreso_total, YES, Mismo_Partido, YES)
/* REGRESION CON nPartidoDesf como numerica

Source |       SS           df       MS      Number of obs   =   102,133
-------------+----------------------------------   F(7, 102125)    =     97.82
       Model |  10.7293994         7  1.53277134   Prob > F        =    0.0000
    Residual |  1600.25918   102,125  .015669613   R-squared       =    0.0067
-------------+----------------------------------   Adj R-squared   =    0.0066
       Total |  1610.98858   102,132  .015773593   Root MSE        =    .12518

-------------------------------------------------------------------------------
        prop1 | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
      Corrupt |   .0007935   .0013804     0.57   0.565     -.001912    .0034991
 nPartidoDesf |   .0003293   .0000179    18.44   0.000     .0002943    .0003643
     Auditada |   .0010582   .0010766     0.98   0.326    -.0010519    .0031683
  CorruptPast |  -.0049382   .0008118    -6.08   0.000    -.0065294    -.003347
 HOMI_CAP_MUN |   4.195555   1.211255     3.46   0.001     1.821511    6.569599
   log_total2 |   -.000952   .0000945   -10.08   0.000    -.0011371   -.0007668
MismoPartidoG |  -.0117006   .0008472   -13.81   0.000     -.013361   -.0100402
        _cons |   .0480061   .0020287    23.66   0.000     .0440298    .0519824
-------------------------------------------------------------------------------
*/

 /* REGRESION CON i.nPartidoDesf como categorica (esta si es)
     Source |       SS           df       MS      Number of obs   =   102,133
-------------+----------------------------------   F(87, 102045)   =     32.30
       Model |  43.1700217        87  .496207146   Prob > F        =    0.0000
    Residual |  1567.81856   102,045  .015363992   R-squared       =    0.0268
-------------+----------------------------------   Adj R-squared   =    0.0260
       Total |  1610.98858   102,132  .015773593   Root MSE        =    .12395

-------------------------------------------------------------------------------
         prop |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
--------------+----------------------------------------------------------------
      Corrupt |   .0016515   .0013965     1.18   0.237    -.0010856    .0043886
              |
 nPartidoDesf |
           2  |  -.0314796   .0166802    -1.89   0.059    -.0641726    .0012134
           3  |   .0866802   .0122218     7.09   0.000     .0627255    .1106348
           4  |  -.0040406   .0124741    -0.32   0.746    -.0284898    .0204085
           5  |   .0080242    .012346     0.65   0.516    -.0161738    .0322223
           6  |  -.0218995   .0121912    -1.80   0.072     -.045794     .001995
           7  |  -.0162236   .0164101    -0.99   0.323    -.0483873      .01594
           8  |  -.0104704   .0139375    -0.75   0.453    -.0377878    .0168471
           9  |   -.024979   .0132726    -1.88   0.060    -.0509932    .0010351
          10  |  -.0267979   .0225717    -1.19   0.235    -.0710382    .0174424
          11  |  -.0148224   .0174654    -0.85   0.396    -.0490545    .0194096
          12  |   .0062798   .0199948     0.31   0.753    -.0329097    .0454693
          13  |  -.0145432   .0121365    -1.20   0.231    -.0383307    .0092442
          14  |   .0131263   .0128425     1.02   0.307    -.0120448    .0382975
          15  |  -.0169397   .0119386    -1.42   0.156    -.0403393    .0064598
          16  |  -.0051724   .0130396    -0.40   0.692    -.0307299    .0203851
          17  |  -.0265918   .0122239    -2.18   0.030    -.0505506   -.0026331
          18  |   .0969882   .0156182     6.21   0.000     .0663767    .1275998
          19  |  -.0130058   .0116429    -1.12   0.264    -.0358259    .0098142
          20  |  -.0182192   .0164023    -1.11   0.267    -.0503675     .013929
          21  |  -.0177321   .0118875    -1.49   0.136    -.0410315    .0055673
          22  |  -.0301836   .0147522    -2.05   0.041    -.0590978   -.0012694
          23  |  -.0149572   .0128508    -1.16   0.244    -.0401446    .0102302
          24  |  -.0271622   .0137628    -1.97   0.048    -.0541371   -.0001872
          25  |  -.0003744   .0122545    -0.03   0.976    -.0243931    .0236444
          26  |  -.0089059   .0150819    -0.59   0.555    -.0384662    .0206544
          27  |  -.0040606   .0116207    -0.35   0.727    -.0268369    .0187158
          28  |   .0163369   .0128069     1.28   0.202    -.0087643    .0414382
          29  |   .0498427    .013017     3.83   0.000     .0243295    .0753559
          30  |    -.02593   .0119532    -2.17   0.030    -.0493582   -.0025018
          31  |   .0393702   .0169311     2.33   0.020     .0061854    .0725549
          32  |  -.0222938   .0125974    -1.77   0.077    -.0469845     .002397
          33  |   -.019179   .0278148    -0.69   0.490    -.0736956    .0353376
          34  |  -.0283924   .0136004    -2.09   0.037    -.0550491   -.0017357
          35  |  -.0057214   .0119399    -0.48   0.632    -.0291233    .0176806
          36  |  -.0126139   .0182297    -0.69   0.489    -.0483438     .023116
          37  |   .0152182   .0156226     0.97   0.330    -.0154019    .0458383
          38  |   .0229431   .0121118     1.89   0.058    -.0007959    .0466821
          39  |   .0046122   .0120057     0.38   0.701    -.0189187    .0281432
          40  |   -.030985   .0229832    -1.35   0.178    -.0760318    .0140618
          41  |  -.0061787   .0121625    -0.51   0.611     -.030017    .0176597
          42  |   .0469194     .01898     2.47   0.013     .0097189    .0841199
          43  |   .0379425   .0149728     2.53   0.011     .0085959     .067289
          44  |   .0203827   .0203398     1.00   0.316     -.019483    .0602485
          45  |   .0292931   .0250976     1.17   0.243    -.0198979     .078484
          46  |   .0570419   .0184911     3.08   0.002     .0207997    .0932842
          47  |  -.0124354    .029427    -0.42   0.673    -.0701119    .0452411
          48  |   .0380264   .0144211     2.64   0.008     .0097612    .0662915
          49  |   .0673703   .0242303     2.78   0.005     .0198792    .1148613
          50  |   .0551787   .0141374     3.90   0.000     .0274696    .0828877
          51  |  -.0241212   .0155034    -1.56   0.120    -.0545077    .0062654
          52  |  -.0035948   .0138126    -0.26   0.795    -.0306674    .0234778
          53  |  -.0117483   .0122324    -0.96   0.337    -.0357236     .012227
          54  |   .0012401   .0129684     0.10   0.924    -.0241777     .026658
          55  |   .0316672   .0261346     1.21   0.226    -.0195562    .0828907
          56  |    .115354   .0376233     3.07   0.002     .0416129    .1890951
          57  |   .0373873   .0242111     1.54   0.123    -.0100662    .0848408
          58  |  -.0205618   .0125157    -1.64   0.100    -.0450924    .0039688
          59  |   .0068733   .0160384     0.43   0.668    -.0245618    .0383084
          60  |  -.0095299    .012953    -0.74   0.462    -.0349176    .0158578
          61  |  -.0286815   .0125173    -2.29   0.022    -.0532152   -.0041478
          62  |  -.0019162   .0115456    -0.17   0.868    -.0245455    .0207131
          63  |   .0132403   .0195457     0.68   0.498    -.0250689    .0515496
          64  |   .0004264   .0137932     0.03   0.975    -.0266081     .027461
          65  |   .0446385   .0630499     0.71   0.479    -.0789384    .1682154
          66  |   .0164486   .0116904     1.41   0.159    -.0064645    .0393617
          67  |   .0143081   .0115936     1.23   0.217    -.0084152    .0370315
          68  |  -.0028151   .0121605    -0.23   0.817    -.0266495    .0210193
          69  |   .0102618   .0273684     0.37   0.708    -.0433799    .0639035
          70  |   .1154936   .0194462     5.94   0.000     .0773794    .1536079
          71  |   .0304128   .0121579     2.50   0.012     .0065835    .0542422
          72  |    .039692   .0120323     3.30   0.001     .0161088    .0632752
          73  |  -.0101805   .0176728    -0.58   0.565     -.044819     .024458
          74  |  -.0379155   .0724958    -0.52   0.601    -.1800063    .1041753
          75  |  -.0178246   .0273468    -0.65   0.515    -.0714239    .0357748
          76  |  -.0087841   .0134195    -0.65   0.513    -.0350862     .017518
          77  |   .0603342    .013021     4.63   0.000     .0348132    .0858552
          78  |    .087974   .0123219     7.14   0.000     .0638233    .1121247
          79  |    -.01954   .0185809    -1.05   0.293    -.0559582    .0168783
          80  |   -.020635   .0124134    -1.66   0.096     -.044965     .003695
          81  |  -.0243531   .0119677    -2.03   0.042    -.0478096   -.0008966
          82  |    .029341   .0137563     2.13   0.033     .0023789    .0563031
              |
     Auditada |   .0019781   .0010944     1.81   0.071    -.0001669    .0041231
  CorruptPast |  -.0021878   .0008699    -2.52   0.012    -.0038928   -.0004828
 HOMI_CAP_MUN |   2.011761   1.370868     1.47   0.142    -.6751229    4.698645
   log_total2 |  -.0007483   .0001023    -7.32   0.000    -.0009488   -.0005478
MismoPartidoG |  -.0003297   .0012785    -0.26   0.796    -.0028356    .0021762
        _cons |   .0522809   .0117372     4.45   0.000      .029276    .0752857
------------------------------------------------------------------------------- */


* c) regresion simple de variable dependiente contra independiente principal + efectos fijos

*primero los voy a sacar todos por separado para ver como se comportan

**efectos fijos por escuela
reghdfe prop Corrupt , absorb (clavedelaescuela)
 
*observamos que cuando se ponen efectos fijos por escuela, ahi si empezamos a ver significancia en la variable explicativa de interes

/*(dropped 1777 singleton observations)
(MWFE estimator converged in 1 iterations)

HDFE Linear regression                            Number of obs   =    100,356
Absorbing 1 HDFE group                            F(   1,  81671) =      16.35
                                                  Prob > F        =     0.0001
                                                  R-squared       =     0.3506
                                                  Adj R-squared   =     0.2020
                                                  Within R-sq.    =     0.0002
                                                  Root MSE        =     0.1118

------------------------------------------------------------------------------
        prop |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     Corrupt |   .0047088   .0011645     4.04   0.000     .0024264    .0069913
       _cons |   .0403388   .0003958   101.91   0.000      .039563    .0411146
------------------------------------------------------------------------------

Absorbed degrees of freedom:
----------------------------------------------------------+
      Absorbed FE | Categories  - Redundant  = Num. Coefs |
------------------+---------------------------------------|
 clavedelaescuela |     18684           0       18684     |
----------------------------------------------------------+
*/

**efectos fijos por grado escolar de los estudiantes 
reghdfe prop Corrupt , absorb (GradoSecundaria) 
*observamos que solo con efectos fijos de grado, no se obtiene significancia en la variable de interes
*NOTA: EL PROFE COMPLEMENTARIO DICE QUE NO METER ESTA COMO EFECTO FIJO SINO COMO VARIABLE CATEGORICA

/*(MWFE estimator converged in 1 iterations)

HDFE Linear regression                            Number of obs   =    102,133
Absorbing 1 HDFE group                            F(   1, 102129) =       1.99
                                                  Prob > F        =     0.1586
                                                  R-squared       =     0.0052
                                                  Adj R-squared   =     0.0052
                                                  Within R-sq.    =     0.0000
                                                  Root MSE        =     0.1253

------------------------------------------------------------------------------
        prop |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     Corrupt |   .0015331   .0010874     1.41   0.159    -.0005981    .0036644
       _cons |    .040838    .000426    95.85   0.000     .0400029     .041673
------------------------------------------------------------------------------

Absorbed degrees of freedom:
---------------------------------------------------------+
     Absorbed FE | Categories  - Redundant  = Num. Coefs |
-----------------+---------------------------------------|
 GradoSecundaria |         3           0           3     |
---------------------------------------------------------+*/

**efectos fijos por año (tiempo)
reghdfe prop Corrupt , absorb (year)

*observamos que con efectos fijos de año unicamente, tampoco se obtiene significancia

/*(MWFE estimator converged in 1 iterations)

HDFE Linear regression                            Number of obs   =    102,133
Absorbing 1 HDFE group                            F(   1, 102124) =       0.96
                                                  Prob > F        =     0.3280
                                                  R-squared       =     0.0075
                                                  Adj R-squared   =     0.0075
                                                  Within R-sq.    =     0.0000
                                                  Root MSE        =     0.1251

------------------------------------------------------------------------------
        prop |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     Corrupt |   .0010695   .0010935     0.98   0.328    -.0010736    .0032127
       _cons |   .0409092    .000426    96.03   0.000     .0400742    .0417441
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
        year |         8           0           8     |
-----------------------------------------------------+*/


*** ahora sacamos la regresion con los tres efectos fijos ******* COMPLETA
reghdfe prop Corrupt , absorb (clavedelaescuela GradoSecundaria year)
outreg2  using myreg3.doc, append ctitle((c)) keep (Corrupt) nocons addtext(EF_Clave_escuela, YES, EF_Grado_Secundaria, YES, EF_Año, YES)
/* REGRESION CON nPartidoDesf como numerica
*observamos que hay significancia y que el coeficiente es ligeramente menor que cuando solo se usan efectos fijos de clave de la escuela, por lo cual los otros efectos fijos si pueden estar ayudando a hallar un estimador menos sesgado
*en general vemos que aqui el coeficiente es positivo, significativo, pero su magnitud creo que es baja (0.004)

/*(dropped 1777 singleton observations)
(MWFE estimator converged in 6 iterations)

HDFE Linear regression                            Number of obs   =    100,356
Absorbing 3 HDFE groups                           F(   1,  81662) =      14.03
                                                  Prob > F        =     0.0002
                                                  R-squared       =     0.3631
                                                  Adj R-squared   =     0.2173
                                                  Within R-sq.    =     0.0002
                                                  Root MSE        =     0.1108

------------------------------------------------------------------------------
        prop |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     Corrupt |   .0043555   .0011627     3.75   0.000     .0020767    .0066344
       _cons |   .0403932   .0003927   102.87   0.000     .0396235    .0411628
------------------------------------------------------------------------------

Absorbed degrees of freedom:
----------------------------------------------------------+
      Absorbed FE | Categories  - Redundant  = Num. Coefs |
------------------+---------------------------------------|
 clavedelaescuela |     18684           0       18684     |
  GradoSecundaria |         3           1           2     |
             year |         8           1           7    ?|
----------------------------------------------------------+
? = number of redundant parameters may be higher*/

*/
* d) regresion simple de variable dependiente contra independiente principal + controles + efectos fijos

reghdfe prop Corrupt i.nPartidoDesf Auditada CorruptPast HOMI_CAP_MUN log_total2 MismoPartidoG , absorb (clavedelaescuela GradoSecundaria year)

/* REGRESION COMPLETA 
HDFE Linear regression                            Number of obs   =    100,356
Absorbing 3 HDFE groups                           F(  87,  81576) =       5.12
                                                  Prob > F        =     0.0000
                                                  R-squared       =     0.3665
                                                  Adj R-squared   =     0.2206
                                                  Within R-sq.    =     0.0054
                                                  Root MSE        =     0.1105

-------------------------------------------------------------------------------
         prop |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
--------------+----------------------------------------------------------------
      Corrupt |   .0030484   .0015422     1.98   0.048     .0000256    .0060711
              |
 nPartidoDesf |
           2  |  -.0184068   .0216044    -0.85   0.394    -.0607513    .0239377
           3  |   .0121009   .0155742     0.78   0.437    -.0184245    .0426263
           4  |  -.0159166   .0163161    -0.98   0.329    -.0478961    .0160629
           5  |  -.0001137   .0162515    -0.01   0.994    -.0319664    .0317391
           6  |  -.0119915   .0153776    -0.78   0.436    -.0421315    .0181485
           7  |   .0036338   .0209519     0.17   0.862    -.0374318    .0446994
           8  |   .0001419    .022029     0.01   0.995    -.0430347    .0433185
           9  |   .0051195   .0162503     0.32   0.753    -.0267311      .03697
          10  |  -.0502239   .0290816    -1.73   0.084    -.1072236    .0067758
          11  |  -.0108361    .028347    -0.38   0.702     -.066396    .0447238
          12  |   .0254827   .0261954     0.97   0.331      -.02586    .0768254
          13  |  -.0517863   .0165547    -3.13   0.002    -.0842334   -.0193392
          14  |  -.0005387   .0164541    -0.03   0.974    -.0327885    .0317111
          15  |  -.0283134   .0153371    -1.85   0.065    -.0583739    .0017471
          16  |   -.000819   .0180783    -0.05   0.964    -.0362523    .0346143
          17  |  -.0242189   .0138477    -1.75   0.080    -.0513603    .0029224
          18  |   .0557347   .0216392     2.58   0.010      .013322    .0981475
          19  |  -.0113686   .0148525    -0.77   0.444    -.0404793    .0177421
          20  |   .0154472   .0193441     0.80   0.425    -.0224672    .0533615
          21  |  -.0229962   .0152177    -1.51   0.131    -.0528228    .0068303
          22  |   -.006658   .0181652    -0.37   0.714    -.0422617    .0289456
          23  |  -.0131488   .0168495    -0.78   0.435    -.0461737    .0198762
          24  |  -.0068321   .0168708    -0.40   0.686    -.0398988    .0262345
          25  |  -.0116352   .0161706    -0.72   0.472    -.0433294     .020059
          26  |    -.00152   .0214312    -0.07   0.943    -.0435249    .0404849
          27  |  -.0155029   .0148212    -1.05   0.296    -.0445525    .0135466
          28  |   .0004278   .0164731     0.03   0.979    -.0318593    .0327149
          29  |   -.046739   .0161566    -2.89   0.004    -.0784058   -.0150722
          30  |  -.0110691   .0151456    -0.73   0.465    -.0407544    .0186162
          31  |    .026474   .0206893     1.28   0.201     -.014077    .0670249
          32  |  -.0192792   .0158311    -1.22   0.223     -.050308    .0117496
          33  |  -.0176066   .0326446    -0.54   0.590    -.0815897    .0463766
          34  |  -.0217302   .0186154    -1.17   0.243    -.0582163    .0147559
          35  |  -.0131259   .0158551    -0.83   0.408    -.0442018    .0179501
          36  |   .0015522   .0209767     0.07   0.941     -.039562    .0426664
          37  |  -.0393762   .0213352    -1.85   0.065     -.081193    .0024406
          38  |   .0088398    .015767     0.56   0.575    -.0220635     .039743
          39  |  -.0034512   .0158058    -0.22   0.827    -.0344304    .0275281
          40  |  -.0317122   .0249546    -1.27   0.204    -.0806231    .0171987
          41  |  -.0028003    .015461    -0.18   0.856    -.0331038    .0275031
          42  |  -.0008266   .0251281    -0.03   0.974    -.0500774    .0484242
          43  |  -.0022216   .0188267    -0.12   0.906    -.0391219    .0346787
          44  |  -.0563866   .0244835    -2.30   0.021    -.1043742   -.0083991
          45  |  -.0562126    .031297    -1.80   0.072    -.1175545    .0051293
          46  |   .0413492   .0248015     1.67   0.095    -.0072616    .0899601
          47  |  -.0270609   .0371677    -0.73   0.467    -.0999094    .0457876
          48  |   .0045125   .0178647     0.25   0.801    -.0305022    .0395272
          49  |    .046733   .0270368     1.73   0.084     -.006259    .0997251
          50  |   .0268399   .0173868     1.54   0.123    -.0072381     .060918
          51  |  -.0211732   .0213788    -0.99   0.322    -.0630755    .0207292
          52  |  -.0037277   .0186402    -0.20   0.841    -.0402623    .0328069
          53  |  -.0132577   .0175835    -0.75   0.451    -.0477213    .0212059
          54  |  -.0296306   .0176282    -1.68   0.093    -.0641818    .0049206
          55  |   .0176541   .0289967     0.61   0.543    -.0391793    .0744875
          56  |  -.0092556   .0445789    -0.21   0.836      -.09663    .0781188
          57  |   .0367607   .0271066     1.36   0.175    -.0163681    .0898895
          58  |  -.0117647   .0160432    -0.73   0.463    -.0432092    .0196798
          59  |  -.0026313   .0216933    -0.12   0.903      -.04515    .0398874
          60  |  -.0112514   .0168893    -0.67   0.505    -.0443542    .0218514
          61  |   .0166537   .0308157     0.54   0.589    -.0437448    .0770522
          62  |  -.0080523   .0146327    -0.55   0.582    -.0367322    .0206276
          63  |   .0062389   .0306325     0.20   0.839    -.0538007    .0662785
          64  |    .006303    .017068     0.37   0.712    -.0271501    .0397562
          65  |  -.0576852   .0657095    -0.88   0.380    -.1864753    .0711049
          66  |  -.0088691   .0148628    -0.60   0.551    -.0380001     .020262
          67  |  -.0064114    .014672    -0.44   0.662    -.0351684    .0223457
          68  |   -.017299   .0156245    -1.11   0.268    -.0479228    .0133249
          69  |  -.0263545    .032648    -0.81   0.420    -.0903443    .0376353
          70  |   .1048541    .024558     4.27   0.000     .0567206    .1529876
          71  |   .0284338   .0165452     1.72   0.086    -.0039948    .0608623
          72  |   .0014959   .0153162     0.10   0.922    -.0285239    .0315156
          73  |  -.0166653    .023856    -0.70   0.485     -.063423    .0300923
          74  |  -.0191211   .1206457    -0.16   0.874    -.2555858    .2173436
          75  |  -.0188193   .0393939    -0.48   0.633    -.0960312    .0583925
          76  |  -.0093337   .0226989    -0.41   0.681    -.0538235     .035156
          77  |    .020475   .0169064     1.21   0.226    -.0126615    .0536114
          78  |   .0281977   .0156489     1.80   0.072    -.0024741    .0588695
          79  |  -.3447171     .10198    -3.38   0.001    -.5445972    -.144837
          80  |  -.0101933   .0160364    -0.64   0.525    -.0416245    .0212379
          81  |  -.0606477   .0165144    -3.67   0.000    -.0930159   -.0282795
          82  |  -.0149394   .0181556    -0.82   0.411    -.0505243    .0206455
              |
     Auditada |  -.0002126   .0011998    -0.18   0.859    -.0025641     .002139
  CorruptPast |  -.0042718   .0017036    -2.51   0.012    -.0076109   -.0009326
 HOMI_CAP_MUN |  -4.737136   2.427816    -1.95   0.051    -9.495638    .0213667
   log_total2 |  -.0001328   .0001459    -0.91   0.363    -.0004188    .0001531
MismoPartidoG |   .0034524   .0015757     2.19   0.028      .000364    .0065408
        _cons |   .0546662   .0150346     3.64   0.000     .0251985    .0841339
-------------------------------------------------------------------------------

Absorbed degrees of freedom:
----------------------------------------------------------+
      Absorbed FE | Categories  - Redundant  = Num. Coefs |
------------------+---------------------------------------|
 clavedelaescuela |     18684           0       18684     |
  GradoSecundaria |         3           1           2     |
             year |         8           1           7    ?|
----------------------------------------------------------+
? = number of redundant parameters may be higher*/


* AHORA: veamos como quedaria sacandole el efecto fijo de GradoSecundaria y metiendola como variable categorica

reghdfe prop Corrupt i.nPartidoDesf Auditada CorruptPast HOMI_CAP_MUN log_total2 MismoPartidoG i.GradoSecundaria, absorb (clavedelaescuela year)
outreg2  using myreg3.doc, append ctitle((d)) keep (Corrupt) nocons addtext(Partido, YES, Auditado?, YES, Corrupt_past, YES, Homicidio, YES, Ingreso_total, YES, Mismo_Partido, YES, Grado_secundaria, YES, EF_Grado_Secundaria, YES, EF_Año, YES)

/* regresion completa version 2, vemos que da exactamente igual el coeficiente de corrupt
HDFE Linear regression                            Number of obs   =    100,356
Absorbing 2 HDFE groups                           F(  89,  81576) =      12.77
                                                  Prob > F        =     0.0000
                                                  R-squared       =     0.3665
                                                  Adj R-squared   =     0.2206
                                                  Within R-sq.    =     0.0137
                                                  Root MSE        =     0.1105

---------------------------------------------------------------------------------
           prop |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
----------------+----------------------------------------------------------------
        Corrupt |   .0030484   .0015422     1.98   0.048     .0000256    .0060711
                |
   nPartidoDesf |
             2  |  -.0184068   .0216044    -0.85   0.394    -.0607513    .0239377
             3  |   .0121009   .0155742     0.78   0.437    -.0184245    .0426263
             4  |  -.0159166   .0163161    -0.98   0.329    -.0478961    .0160629
             5  |  -.0001137   .0162515    -0.01   0.994    -.0319664    .0317391
             6  |  -.0119915   .0153776    -0.78   0.436    -.0421315    .0181485
             7  |   .0036338   .0209519     0.17   0.862    -.0374318    .0446994
             8  |   .0001419    .022029     0.01   0.995    -.0430347    .0433185
             9  |   .0051195   .0162503     0.32   0.753    -.0267311      .03697
            10  |  -.0502239   .0290816    -1.73   0.084    -.1072236    .0067758
            11  |  -.0108361    .028347    -0.38   0.702     -.066396    .0447238
            12  |   .0254827   .0261954     0.97   0.331      -.02586    .0768254
            13  |  -.0517863   .0165547    -3.13   0.002    -.0842334   -.0193392
            14  |  -.0005387   .0164541    -0.03   0.974    -.0327885    .0317111
            15  |  -.0283134   .0153371    -1.85   0.065    -.0583739    .0017471
            16  |   -.000819   .0180783    -0.05   0.964    -.0362523    .0346143
            17  |  -.0242189   .0138477    -1.75   0.080    -.0513603    .0029224
            18  |   .0557347   .0216392     2.58   0.010      .013322    .0981475
            19  |  -.0113686   .0148525    -0.77   0.444    -.0404793    .0177421
            20  |   .0154472   .0193441     0.80   0.425    -.0224672    .0533615
            21  |  -.0229962   .0152177    -1.51   0.131    -.0528228    .0068303
            22  |   -.006658   .0181652    -0.37   0.714    -.0422617    .0289456
            23  |  -.0131488   .0168495    -0.78   0.435    -.0461737    .0198762
            24  |  -.0068321   .0168708    -0.40   0.686    -.0398988    .0262345
            25  |  -.0116352   .0161706    -0.72   0.472    -.0433294     .020059
            26  |    -.00152   .0214312    -0.07   0.943    -.0435249    .0404849
            27  |  -.0155029   .0148212    -1.05   0.296    -.0445525    .0135466
            28  |   .0004278   .0164731     0.03   0.979    -.0318593    .0327149
            29  |   -.046739   .0161566    -2.89   0.004    -.0784058   -.0150722
            30  |  -.0110691   .0151456    -0.73   0.465    -.0407544    .0186162
            31  |    .026474   .0206893     1.28   0.201     -.014077    .0670249
            32  |  -.0192792   .0158311    -1.22   0.223     -.050308    .0117496
            33  |  -.0176066   .0326446    -0.54   0.590    -.0815897    .0463766
            34  |  -.0217302   .0186154    -1.17   0.243    -.0582163    .0147559
            35  |  -.0131259   .0158551    -0.83   0.408    -.0442018    .0179501
            36  |   .0015522   .0209767     0.07   0.941     -.039562    .0426664
            37  |  -.0393762   .0213352    -1.85   0.065     -.081193    .0024406
            38  |   .0088398    .015767     0.56   0.575    -.0220635     .039743
            39  |  -.0034512   .0158058    -0.22   0.827    -.0344304    .0275281
            40  |  -.0317122   .0249546    -1.27   0.204    -.0806231    .0171987
            41  |  -.0028003    .015461    -0.18   0.856    -.0331038    .0275031
            42  |  -.0008266   .0251281    -0.03   0.974    -.0500774    .0484242
            43  |  -.0022216   .0188267    -0.12   0.906    -.0391219    .0346787
            44  |  -.0563866   .0244835    -2.30   0.021    -.1043742   -.0083991
            45  |  -.0562126    .031297    -1.80   0.072    -.1175545    .0051293
            46  |   .0413492   .0248015     1.67   0.095    -.0072616    .0899601
            47  |  -.0270609   .0371677    -0.73   0.467    -.0999094    .0457876
            48  |   .0045125   .0178647     0.25   0.801    -.0305022    .0395272
            49  |    .046733   .0270368     1.73   0.084     -.006259    .0997251
            50  |   .0268399   .0173868     1.54   0.123    -.0072381     .060918
            51  |  -.0211732   .0213788    -0.99   0.322    -.0630755    .0207292
            52  |  -.0037277   .0186402    -0.20   0.841    -.0402623    .0328069
            53  |  -.0132577   .0175835    -0.75   0.451    -.0477213    .0212059
            54  |  -.0296306   .0176282    -1.68   0.093    -.0641818    .0049206
            55  |   .0176541   .0289967     0.61   0.543    -.0391793    .0744875
            56  |  -.0092556   .0445789    -0.21   0.836      -.09663    .0781188
            57  |   .0367607   .0271066     1.36   0.175    -.0163681    .0898895
            58  |  -.0117647   .0160432    -0.73   0.463    -.0432092    .0196798
            59  |  -.0026313   .0216933    -0.12   0.903      -.04515    .0398874
            60  |  -.0112514   .0168893    -0.67   0.505    -.0443542    .0218514
            61  |   .0166537   .0308157     0.54   0.589    -.0437448    .0770522
            62  |  -.0080523   .0146327    -0.55   0.582    -.0367322    .0206276
            63  |   .0062389   .0306325     0.20   0.839    -.0538007    .0662785
            64  |    .006303    .017068     0.37   0.712    -.0271501    .0397562
            65  |  -.0576852   .0657095    -0.88   0.380    -.1864753    .0711049
            66  |  -.0088691   .0148628    -0.60   0.551    -.0380001     .020262
            67  |  -.0064114    .014672    -0.44   0.662    -.0351684    .0223457
            68  |   -.017299   .0156245    -1.11   0.268    -.0479228    .0133249
            69  |  -.0263545    .032648    -0.81   0.420    -.0903443    .0376353
            70  |   .1048541    .024558     4.27   0.000     .0567206    .1529876
            71  |   .0284338   .0165452     1.72   0.086    -.0039948    .0608623
            72  |   .0014959   .0153162     0.10   0.922    -.0285239    .0315156
            73  |  -.0166653    .023856    -0.70   0.485     -.063423    .0300923
            74  |  -.0191211   .1206457    -0.16   0.874    -.2555858    .2173436
            75  |  -.0188193   .0393939    -0.48   0.633    -.0960312    .0583925
            76  |  -.0093337   .0226989    -0.41   0.681    -.0538235     .035156
            77  |    .020475   .0169064     1.21   0.226    -.0126615    .0536114
            78  |   .0281977   .0156489     1.80   0.072    -.0024741    .0588695
            79  |  -.3447171     .10198    -3.38   0.001    -.5445972    -.144837
            80  |  -.0101933   .0160364    -0.64   0.525    -.0416245    .0212379
            81  |  -.0606477   .0165144    -3.67   0.000    -.0930159   -.0282795
            82  |  -.0149394   .0181556    -0.82   0.411    -.0505243    .0206455
                |
       Auditada |  -.0002126   .0011998    -0.18   0.859    -.0025641     .002139
    CorruptPast |  -.0042718   .0017036    -2.51   0.012    -.0076109   -.0009326
   HOMI_CAP_MUN |  -4.737136   2.427816    -1.95   0.051    -9.495638    .0213667
     log_total2 |  -.0001328   .0001459    -0.91   0.363    -.0004188    .0001531
  MismoPartidoG |   .0034524   .0015757     2.19   0.028      .000364    .0065408
                |
GradoSecundaria |
             2  |   .0172848   .0009956    17.36   0.000     .0153334    .0192362
             3  |   .0257445   .0010004    25.73   0.000     .0237837    .0277053
                |
          _cons |   .0386357   .0150519     2.57   0.010      .009134    .0681373
---------------------------------------------------------------------------------

Absorbed degrees of freedom:
----------------------------------------------------------+
      Absorbed FE | Categories  - Redundant  = Num. Coefs |
------------------+---------------------------------------|
 clavedelaescuela |     18684           0       18684     |
             year |         8           1           7     |
----------------------------------------------------------+*/



**********************
*HASTA AQUI VA EL CODIGO DEL TALLER COMO TALLER

* A CONTINUACION, TENEMOS QUE SACAR LAS TABLAS CONFORME LO SOLICITAN EN EL TALLER 



